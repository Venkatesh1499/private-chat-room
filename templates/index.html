<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Chat App</title>
    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js" integrity="sha384-mkQ3/7FUtcGyoppY6bz/PORYoGqOl7/aSUMn2ymDOJcapfS6PHqxhRTMh1RR0Q6+" crossorigin="anonymous"></script>
</head>
<body>
    <h2>Private Chat App</h2>

    <input id = "room" placeholder="Enter room id"/>
    <button onclick="joinRoom()">Join Room</button>

    <br><br>

    <input id = "msg" placeholder="Enter your message"/>
    <button onclick="sendMessage()">Send message</button>

    <ul id="messages"></ul>

    <script>
        const socket = io({
            transports: ["websocket"]
        });
        let currentRoom = "";

        function joinRoom() {
            const inputRoom = document.getElementById("room");
            currentRoom = inputRoom.value;
            socket.emit("join_room", { room: currentRoom });
        }

        function sendMessage() {
            if (!currentRoom) {
                alert("Join a room first");
                return;
            }
            const inputMessage = document.getElementById("msg");
            socket.emit("room_message", {
                room: currentRoom,
                message: inputMessage.value
            });
            inputMessage.value = "";
        }

        socket.on("room_message", (data) => {
            const li = document.createElement("li");
            li.innerText = data.message;

            document.getElementById("messages").appendChild(li);
        });

    </script>

</body>
</html>